<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Memo</title>
    <link rel="stylesheet" href="answer.css">
</head>
<body onload="myInit()">
    <div class="wrap">
        <!-- 스티커 메모 -->
        <div id="memo" class="memo" style="top:100px;left:100px;">
            <div id="header" class="header">
                <h1 class="blind">메모장</h1>
                <button id="btn_close" class="btn_close" onclick="delteDiv()"><span class="blind">닫기</span></button>
            </div>
            <div class="content">
                <div class="textarea" contenteditable="true" style="width:200px; height:100px;">
                    메모 하십시오! 메모 하십시오!메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                    메모 하십시오!<br>
                </div>
                <button class="btn_size" onclick="resizeDiv(this.id)"><span class="blind">메모장 크기 조절</span></button>
            </div>
        </div>
        <!--// 스티커 메모 -->
    </div>
    <script src="./util.js"></script>
    <script>
        // function myInit () {
        //     // let div = document.createElement(localStorage.getItem('now'));
        //     // console.log(localStorage.getItem('now'))
        //     // document.getElementsByClassName('wrap')[0].appendChild(localStorage.getItem('now'))
        //     if (localStorage.getItem('now').length > 0) {
        //         document.getElementsByClassName("wrap")[0].innerHTML = localStorage.getItem('now')

        //     }
        // }
        // document.addEventListener('mousedown', ()=>{
            
        //     //오른쪽 버튼
        //     if(event.button === 2 || event.which === 3) {
        //         // const div = document.getElementsByClassName('wrap');
        //         const newMemo = document.getElementsByClassName('memo');
        //         const cloneDiv = newMemo[0].cloneNode(true);
        //         cloneDiv.id = 'memo_' + event.clientX;
        //         cloneDiv.style.top = event.clientY + "px";
        //         cloneDiv.style.left = event.clientX + "px";
        //         document.getElementsByClassName('wrap')[0].appendChild(cloneDiv);
        //     }

        //     const store = document.getElementsByClassName('wrap')[0].innerHTML;
            
        //     try {
        //         localStorage.setItem('now', store)
        //     } catch (error) {
        //         console.log(error);
        //     }
            
        // })
        
        //클릭
        // document.addEventListener('click',(e)=>{
        //     // console.log(e.target.getAttribute('id').parentNode)
        //     // const clickDiv = document.getElementById(e.target.getAttribute('id'));
        //     if (e.target.offsetParent.id.length > 0) {
                
        //         // document.querySelector('.memo').style.zIndex = 0;
        //         var hiClass = document.getElementsByClassName("memo");
        //         for(var i=0, len=hiClass.length; i<len; i++) {
        //             hiClass[i].style["z-index"] = 0;
        //         }
                
        //         dragElement(e.target.offsetParent);
        //     } else {
        //         var hiClass = document.getElementsByClassName("memo");
        //         for(var i=0, len=hiClass.length; i<len; i++) {
        //             hiClass[i].style["z-index"] = 0;
        //         }
        //         e.path[2].style["z-index"] =1;
        //     }
        // })
        // //드래그
        // function dragElement(el) {
        //     let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
        //     el.style.zIndex = 1;
        //     // console.log(el.childNodes)
        //     if (el.childNodes[1]) {
        //         el.childNodes[1].onmousedown = dragMouseDown;
        //     } else {
        //         /* otherwise, move the DIV from anywhere inside the DIV:*/
        //         el.onmousedown = dragMouseDown;
        //     }
        //     function dragMouseDown(e) {
        //         e = e || window.event;
        //         e.preventDefault();
        //         // get the mouse cursor position at startup:
        //         pos3 = e.clientX;
        //         pos4 = e.clientY;
        //         document.onmouseup = closeDragElement;
        //         // call a function whenever the cursor moves:
        //         document.onmousemove = elementDrag;
        //     }
        //     function elementDrag(e) {
        //         e = e || window.event;
        //         e.preventDefault();
        //         // calculate the new cursor position:
        //         pos1 = pos3 - e.clientX;
        //         pos2 = pos4 - e.clientY;
        //         pos3 = e.clientX;
        //         pos4 = e.clientY;
        //         // set the element's new position:
        //         el.style.top = (el.offsetTop - pos2) + "px";
        //         el.style.left = (el.offsetLeft - pos1) + "px";
        //     }
        //     function closeDragElement() {
        //         /* stop moving when mouse button is released:*/
        //         document.onmouseup = null;
        //         document.onmousemove = null;
        //     }
        // }
        function delteDiv() {
            // const buttonDiv = document.getElementById("btn_close");
            document.addEventListener('click',(e)=>{
                const div = e.path[2];
                if (e.target.id === 'btn_close') {
                    div.remove();
                }
            })
        }
        function resizeDiv() {
            // const textDiv = event.path[1].childNodes[1];            
            const memoDiv = event.target.offsetParent.offsetParent.id;
            // const parentDiv = e.target.offsetParent;
            // console.log(textDiv)
            const memoId = document.getElementById(memoDiv);
            let x = 0, y = 0;
            memoId.addEventListener("mousedown",(e)=>{
                // e.preventDefault();
                // console.log(e.path[1].childNodes[1])
                const rect = e.path[1].childNodes[1].getBoundingClientRect();
                
                // const x = event.clientX - rect.left;
                // const y = event.clientY - rect.top;
                // const w = rect.right - e.clientX;
                // const w = event.clientX - event.clientY;
                // console.log( e.path[1].childNodes[1].onmousedown.clientX)
                // console.log(e.path[1].childNodes[1].style)
                // e.path[1].childNodes[1].style.width = x + 'px';
                mouseMove(rect);
            })
            function mouseMove (_rect) {
                memoId.addEventListener("mousemove",(e)=>{
                    x = event.clientX - _rect.left;
                    y = event.clientY - _rect.top;
                    
                    e.path[1].childNodes[1].style.width = x + 'px';
                    e.path[1].childNodes[1].style.height = y + 'px';
                    
                })
            }
            
        }
        

        
    </script>    
</body>
</html>
